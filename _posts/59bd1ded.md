---
title: "二項定理"
weight: 260
num: 242
hash: "59bd1ded"
tags: ["math"]
---

## 解説/アルゴリズム

$(a+b)^2$ を展開すると、 $a^2 + 2ab + b^2$ になるが、この展開方法について考えてみる。

$(a+b)^2$ は $(a+b)(a+b)$ のことだが、この式を更に展開するには各因数から a または b を取り出し、それらを掛け合わして $a^2$ や $ab$ のような項を作る。そして、組み合わせてできる項を全て列挙して足し合わせたものが $a^2 + 2ab + b^2$ になる。

| 因数 1 | 因数 2 | 掛け合わせてできた項 |
| :----- | :----- | :------------------- |
| $a$    | $a$    | $a^2$                |
| $a$    | $b$    | $ab$                 |
| $b$    | $a$    | $ab$                 |
| $b$    | $b$    | $b^2$                |

たとえば 2 つの因数から 2 つとも a を選ぶと $a^2$ 、 2 つとも b を選ぶと $b^2$ になる。

$a^2$ と $b^2$ の取り出し方はこれしかないので係数が 1 になる。

一方、 $ ab $ の取り出し方は 2 パターンあるので係数が 2 になる。

次は $(a+b)^3$ の展開方法について考えてみる。

| 因数 1 | 因数 2 | 因数 3 | 掛け合わせた数 |
| :----- | :----- | :----- | :------------- |
| $a$    | $a$    | $a$    | $a^3$          |
| $b$    | $b$    | $b$    | $b^3$          |
| $a$    | $a$    | $b$    | $a^2b$         |
| $a$    | $b$    | $a$    | $a^2b$         |
| $b$    | $a$    | $a$    | $a^2b$         |
| $a$    | $b$    | $b$    | $ab^2$         |
| $b$    | $a$    | $b$    | $ab^2$         |
| $b$    | $b$    | $a$    | $ab^2$         |

$a^3$ と $b^3$ の取り出し方は 1 通り、 $a^2b$ と $ab^2$ は 3 通りあるので、 $(a+b)^3$ は $a^3 + 3a^2b + 3ab^2 + b^3$ に展開されることがわかる。

ここで重要なポイントがあり、どの項も次数が必ず 3 になる。

上記の表の通り、各因数から a または b を 3 回取り出して掛け合わせているので、 $(a+b)^3$ を展開した各項の次数は必ず 3 になる。

| 項      | a の数 | b の数 | a と b の数（次数） |
| :------ | :----- | :----- | :------------------ |
| $a^3$   | 3      | 0      | 3                   |
| $3a^2b$ | 2      | 1      | 3                   |
| $3ab^2$ | 1      | 2      | 3                   |
| $b^3$   | 0      | 3      | 3                   |

$(a+b)^3$ を展開した式では、次数が 3 になる組み合わせの項すべてが並ぶことになる。

この規則性が分かっていれば、 $(a+b)^n$ を展開してできる式の、係数以外の情報は簡単に知ることができ、例えば $(a+b)^4$ の係数を除いた式は下記の通り。

$a^4 + a^3b + a^2b^2 + ab^3 + b^4$

次数が 4 になる a と b の組み合わせを列挙して足し合わせている。

たとえば a が 4 であれば b が 0、a が 3 あれば b が 1 のように、次数の数が n で a の数が r だと、b の数が n - r になる。

次は係数の求め方について考えてみる。

たとえば $(a+b)^3$ を展開して出てくる項 $3ab^2$ では b が 2 つあるが、これは因数から a か b を選択するとき、 3 回中 2 回 b を選択したということになる。

3 回中 2 回 b を選択してできる項の数は $_3 \mathrm{C} _2$ のように[組み合わせ](/10c33141)で計算可能。

$(a+b)^3$ を展開すると、 b の数がそれぞれ 0 個、 1 個、 2 個、 3 個の項がでてくるわけだから、係数はそれぞれ組み合わせの計算である $_3 \mathrm{C} _0$ , $_3 \mathrm{C} _1$ , $_3 \mathrm{C} _2$ , $_3 \mathrm{C} _3$ で算出できる。

| b の数 | 係数の計算式       | 係数 |
| :----- | :----------------- | :--- |
| 0      | $_3 \mathrm{C} _0$ | 1    |
| 1      | $_3 \mathrm{C} _1$ | 3    |
| 2      | $_3 \mathrm{C} _2$ | 3    |
| 3      | $_3 \mathrm{C} _3$ | 1    |

これで各項の係数の計算方法がわかったので、先に説明した各項の次数の計算と合わせると、 $(a+b)^3$ の展開式は下記のとおりになる。

$(a+b)^3 = {_3 \mathrm{C} _0a^3} + {_3 \mathrm{C} _1a^2b} + {_3 \mathrm{C} _2ab^2} + {_3 \mathrm{C} _3b^3}$

べき乗部分を n に変えて一般化すると下記のような式になり、これを`二項定理`と呼ぶ。

$(a+b)^n = {_n \mathrm{C} _0a^n} + {_n \mathrm{C} _1a^{n-1}b} + {_n \mathrm{C} _2a^{n-2}b^2} + ... {_n \mathrm{C} _{n-1}ab^{n-1}} + {_n \mathrm{C} _nb^n}$

ここで、各項の係数の計算方法である組み合わせ $_n \mathrm{C} _0$ , $_n \mathrm{C} _1$ , $_n \mathrm{C} _2$ , ... , $_n \mathrm{C} _{n-1}$ , $_n \mathrm{C} _n$ を`二項係数`と呼ぶ。

### パスカルの三角形

```text
      0C0
    1C0 1C1
  2C0 2C1 2C2
3C0 3C1 3C2 3C3
```

```text
   1
  1 1
 1 2 1
1 3 3 1
```

二項係数の組み合わせ数を三角形上に並べたものを`パスカルの三角形`と呼ぶ。

上端、左端、右端は 1、それ以外の場所は自身の左上と右上の値を足した数になり、たとえば $_3 \mathrm{C} _1 = {_2\mathrm{C} _0} + {_2 \mathrm{C} _1}$ になる。

これを利用して組み合わせ数を計算するコードは [別記事](/10c33141) に記載している。
