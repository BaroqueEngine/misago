{"pageProps":{"post":{"title":"正規化","slug":"2c7dcb93","content":"<h2>概要</h2>\n<p>ある値が範囲の中でどの地点にあるかを割合で表す計算のことを<code>正規化</code>と呼ぶ。</p>\n<h2>コード例</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">norm</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> v<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">-</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">-</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0.5</span>\n</code></pre>\n<p>a, b, v の 3 つの値を渡して、a ～ b を 0 ～ 1 の範囲と考えたとき、v がどの地点にあるかを計算する。</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// -0.5</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">norm</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1.5</span>\n</code></pre>\n<p>v が a ～ b の範囲に無い値の場合は、返却される値が 0 未満または 1 より大きくなる。</p>\n<h2>解説/アルゴリズム</h2>\n<p>5 割や 50% というのは 0.5 のことだが、これは <code>5 / 10 = 0.5</code>、<code>50 / 100 = 0.5</code> のように対象の値を上限値で割ることで 0.0 ～ 1.0 の範囲に変換している。</p>\n<pre class=\"language-text\"><code class=\"language-text\">対象の値 / 範囲の上限値\n</code></pre>\n<p>5 割は 0 ～ 10 割の範囲の中にあるので <code>5 / 10</code> 、50% は 0 ～ 100% の範囲の中にあるので <code>5 / 100</code> という計算をすれば範囲の中で値がどの位置にあるかを計算できる。</p>\n<p>対象の値を 40、範囲を 0 ～ 200 とすると、 <code>40 / 200 = 0.2</code> 、つまり 40 という値は 0 ～ 200 の範囲の中で 0.2 (20%) の位置にある値ということが分かる。</p>\n<p>ただし、範囲の下限が 0 ではない場合は計算が上記より複雑になる。</p>\n<p>たとえば範囲が 20 ～ 100 の場合で、対象の値が 50 の場合、これは範囲の真ん中にある値ではない。</p>\n<p>この場合の解決方法として、下限値を 0 にするように範囲の幅をずらす方法がある。</p>\n<p>20 ～ 100 の範囲の場合、下限/上限とも下限の値である 20 を引いて、0 ～ 80 の範囲に変換する。</p>\n<p>対象の値も同じように 20 を引いて<code>50-20=30</code>に変換する。</p>\n<p>それぞれの値自体は計算によって変わりはしたが、同じ値を引いているので対象の値が範囲の中でのポジションが変わることはない。</p>\n<p>あとは先程の手順通り、対象の値を上限値で割るだけで正規化できる。</p>\n<pre class=\"language-text\"><code class=\"language-text\">(対象の値 - 下限値) / (上限値 - 下限値)\n</code></pre>\n<p>対象の値が 50、範囲が 20 ～ 100 なので、<code>(50 - 20) / (100 - 20) = 0.375</code>で、20 ～ 100 の範囲で 50 は 37.5%の位置にあるということがわかる。</p>\n"}},"__N_SSG":true}