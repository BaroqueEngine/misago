{"pageProps":{"post":{"title":"マップ生成2","slug":"92c5bea7","content":"<h2>実行例</h2>\n<p><img src=\"./static/images/92c5bea7/0.png\" alt=\"\">\n<a href=\"./static/play/92c5bea7/index.html\">実行結果を見る</a></p>\n<h2>ソースコード</h2>\n<p><a href=\"./static/code/92c5bea7/app.ts\">app.ts</a></p>\n<h2>解説/アルゴリズム</h2>\n<ol>\n<li>二次元配列を用意します。</li>\n<li>配列の中身を、40%の確率で島の値、60%の確率で海の値になるように埋めていきます。</li>\n<li>縦横サイズを超えないランダムな(x, y)位置を取得します。</li>\n<li>(x, y)位置にある、セルの周り 3x3 の海の数を数えます。（自身のセルも含める）</li>\n<li>3x3 の海の数が 5 未満なら、(x, y)位置のセル値を海に、そうでなければ島に変えます。</li>\n<li>上記 3 ～ 5 を 40000 回繰り返します。</li>\n<li>配列の値をもとに描画を行います。</li>\n</ol>\n<h2>コード解説</h2>\n<h3>配列の初期化</h3>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">map <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> y <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> y <span class=\"token operator\">&lt;</span> tileHeight<span class=\"token punctuation\">;</span> y<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  map<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> x <span class=\"token operator\">&lt;</span> tileWidth<span class=\"token punctuation\">;</span> x<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    map<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> fillProbability <span class=\"token operator\">?</span> CellType<span class=\"token punctuation\">.</span>land <span class=\"token operator\">:</span> CellType<span class=\"token punctuation\">.</span>sea<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>配列の中身を、40%の確率で島の値、60%の確率で海の値になるように埋めていきます。</p>\n<h3>壁の数を数える</h3>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> tx <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span>tileWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ty <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span>tileHeight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmap<span class=\"token punctuation\">[</span>ty<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>tx<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span> <span class=\"token operator\">&lt;</span> <span class=\"token function\">getNeighborSeaCount</span><span class=\"token punctuation\">(</span>tx<span class=\"token punctuation\">,</span> ty<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> CellType<span class=\"token punctuation\">.</span>sea <span class=\"token operator\">:</span> CellType<span class=\"token punctuation\">.</span>land<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>ランダムな位置を取得します。<br>\nその位置にあるセルの周り 3x3 にある海の数をカウントします。（自身もカウントに含める）<br>\n海の数が 5 以上であればそのセルを海に、でなければ島に変換します。</p>\n"}},"__N_SSG":true}