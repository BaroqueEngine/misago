{"pageProps":{"post":{"title":"パーティクルのライフスパン","slug":"b56cd6b9","content":"<h2>実行例</h2>\n<p><img src=\"./static/images/b56cd6b9/0.png\" alt=\"\">\n<a href=\"./static/play/b56cd6b9/index.html\">実行結果を見る</a></p>\n<h2>ソースコード</h2>\n<h3>TypeScript</h3>\n<p><a href=\"./static/code/b56cd6b9/particle.ts\">particle.ts</a> / <a href=\"./static/code/b56cd6b9/app.ts\">app.ts</a></p>\n<h2>解説/アルゴリズム</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">Particle</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  x<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  y<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  vx<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  vy<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  radius<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  opacity<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  lifespan<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  damage<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>\n  x<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  y<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  vx<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  vy<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  radius<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  opacity<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  lifespan<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span>\n  damage<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Particle <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> vx<span class=\"token punctuation\">,</span> vy<span class=\"token punctuation\">,</span> radius<span class=\"token punctuation\">,</span> opacity<span class=\"token punctuation\">,</span> lifespan<span class=\"token punctuation\">,</span> damage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">:</span> Particle<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  p<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+=</span> p<span class=\"token punctuation\">.</span>vx<span class=\"token punctuation\">;</span>\n  p<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+=</span> p<span class=\"token punctuation\">.</span>vy<span class=\"token punctuation\">;</span>\n  p<span class=\"token punctuation\">.</span>lifespan <span class=\"token operator\">-=</span> p<span class=\"token punctuation\">.</span>damage<span class=\"token punctuation\">;</span>\n  p<span class=\"token punctuation\">.</span>lifespan <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">.</span>lifespan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">isDead</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">:</span> Particle<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">.</span>lifespan <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>Particle に lifespan, damage プロパティを追加して、update()が呼ばれるたびに damage 分だけ lifespan を減らしていきます。<br>\n0 になったら死亡した見なしてオブジェクトを削除します。</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">p<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>lifespan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>ライフスパンの値に応じて透明度を変更するような見た目に影響を与える処理を加えても面白いと思います。</p>\n"}},"__N_SSG":true}