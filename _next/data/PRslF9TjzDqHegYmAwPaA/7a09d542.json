{"pageProps":{"post":{"title":"一つずつパーティクルを出す","slug":"7a09d542","content":"<h2>実行例</h2>\n<p><img src=\"./static/images/7a09d542/0.png\" alt=\"\">\n<a href=\"./static/play/7a09d542/index.html\">実行結果を見る</a></p>\n<h2>ソースコード</h2>\n<h3>TypeScript</h3>\n<p><a href=\"./static/code/7a09d542/particle.ts\">particle.ts</a> / <a href=\"./static/code/7a09d542/app.ts\">app.ts</a></p>\n<h2>解説/アルゴリズム</h2>\n<p>パーティクルの個々の要素を一定間隔で生成するように調整を行います。</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">p<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">draw</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  p<span class=\"token punctuation\">.</span><span class=\"token function\">background</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">.</span>background<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  p<span class=\"token punctuation\">.</span><span class=\"token function\">noStroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>frameCount <span class=\"token operator\">%</span> interval <span class=\"token operator\">===</span> <span class=\"token number\">0</span> <span class=\"token operator\">&&</span> particles<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> maxParticle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">addParticle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  particles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>particle<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>particle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>opacity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">circle</span><span class=\"token punctuation\">(</span>particle<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">addParticle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> vx <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> vy <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> radius <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> opacity <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> particle <span class=\"token operator\">=</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>\n    p<span class=\"token punctuation\">.</span>windowWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    p<span class=\"token punctuation\">.</span>windowHeight <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    vx<span class=\"token punctuation\">,</span>\n    vy<span class=\"token punctuation\">,</span>\n    radius<span class=\"token punctuation\">,</span>\n    opacity\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  particles<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>particle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>更新用関数の全体コードです。</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">p<span class=\"token punctuation\">.</span>frameCount <span class=\"token operator\">%</span> interval <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p><code>intreval</code>フレームおきに生成するように調整します。</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">particles<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> maxParticle<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>時間の経過につれて無尽蔵にオブジェクトの数が増えるので、生成の制限をしておきます。</p>\n"}},"__N_SSG":true}