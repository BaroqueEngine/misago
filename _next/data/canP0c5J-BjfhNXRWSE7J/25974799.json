{"pageProps":{"post":{"title":"雑な線","slug":"25974799","content":"<h2>実行例</h2>\n<p><img src=\"./static/images/25974799/0.png\" alt=\"\">\n<a href=\"./static/play/25974799/index.html\">実行結果を見る</a></p>\n<h2>解説/アルゴリズム</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> p5 <span class=\"token keyword\">from</span> <span class=\"token string\">\"p5\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">p5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">:</span> p5<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">line</span><span class=\"token punctuation\">(</span>x1<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y1<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> x2<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y2<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 始点(x1, y1)と終点(x2, y2)をもとの位置から半径r以内のランダムな場所に移動</span>\n    <span class=\"token comment\">// (x1, y1)が(tx1, ty1)に, (x2, y2)が(tx4, ty4)になる。</span>\n    <span class=\"token keyword\">const</span> rad0 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span><span class=\"token constant\">TWO_PI</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> rad1 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span><span class=\"token constant\">TWO_PI</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> r <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> r0 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> r1 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> tx1 <span class=\"token operator\">=</span> x1 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>rad0<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> r0<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> ty1 <span class=\"token operator\">=</span> y1 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>rad0<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> r0<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> tx4 <span class=\"token operator\">=</span> x2 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>rad1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> r1<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> ty4 <span class=\"token operator\">=</span> y2 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>rad1<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> r1<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 始点から終点への角度を少しずらした角度を計算し、</span>\n    <span class=\"token comment\">// その角度の方向に線を伸ばした50%/75%の位置を3次ベジェ曲線の制御点にする。</span>\n    <span class=\"token keyword\">const</span> dx <span class=\"token operator\">=</span> tx4 <span class=\"token operator\">-</span> tx1<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> dy <span class=\"token operator\">=</span> ty4 <span class=\"token operator\">-</span> ty1<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> d <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">dist</span><span class=\"token punctuation\">(</span>tx1<span class=\"token punctuation\">,</span> ty1<span class=\"token punctuation\">,</span> tx4<span class=\"token punctuation\">,</span> ty4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> rad2 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">atan2</span><span class=\"token punctuation\">(</span>dy<span class=\"token punctuation\">,</span> dx<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> tx2 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">lerp</span><span class=\"token punctuation\">(</span>tx1<span class=\"token punctuation\">,</span> tx1 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>rad2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> d<span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> ty2 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">lerp</span><span class=\"token punctuation\">(</span>ty1<span class=\"token punctuation\">,</span> ty1 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>rad2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> d<span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> tx3 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">lerp</span><span class=\"token punctuation\">(</span>tx1<span class=\"token punctuation\">,</span> tx1 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>rad2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> d<span class=\"token punctuation\">,</span> <span class=\"token number\">0.75</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> ty3 <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">lerp</span><span class=\"token punctuation\">(</span>ty1<span class=\"token punctuation\">,</span> ty1 <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>rad2<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> d<span class=\"token punctuation\">,</span> <span class=\"token number\">0.75</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">strokeWeight</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">bezier</span><span class=\"token punctuation\">(</span>tx1<span class=\"token punctuation\">,</span> ty1<span class=\"token punctuation\">,</span> tx2<span class=\"token punctuation\">,</span> ty2<span class=\"token punctuation\">,</span> tx3<span class=\"token punctuation\">,</span> ty3<span class=\"token punctuation\">,</span> tx4<span class=\"token punctuation\">,</span> ty4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">rect</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">line</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> x <span class=\"token operator\">+</span> width<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">line</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">line</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">+</span> width<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> x <span class=\"token operator\">+</span> width<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">line</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> height<span class=\"token punctuation\">,</span> x <span class=\"token operator\">+</span> width<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  p<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">setup</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"canvas-container\"</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">noFill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#ff9900\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">rect</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  p<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">mouseClicked</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}},"__N_SSG":true}