{"pageProps":{"post":{"title":"マウス","slug":"c01286ec","content":"<h2>解説/アルゴリズム</h2>\n<p>ブラウザでマウスを扱うために、TypeScript からクリックやオーバーのようなイベント、どのボタンが押されたか、キーとの連携などが取得できます。</p>\n<h2>マウスイベント</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">イベント名</th>\n<th style=\"text-align:left\">発生する条件</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">mousedown</td>\n<td style=\"text-align:left\">要素上でマウスボタンが押された</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">mouseup</td>\n<td style=\"text-align:left\">要素上でマウスボタンが離された</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">mouseover</td>\n<td style=\"text-align:left\">外から要素内にマウスポイントが入ってきた</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">mouseout</td>\n<td style=\"text-align:left\">要素内から外にマウスポイントが出た</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">mousemove</td>\n<td style=\"text-align:left\">要素上でマウスが動かされた</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">click</td>\n<td style=\"text-align:left\">要素上でマウスボタンがクリックされた</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">contextmenu</td>\n<td style=\"text-align:left\">要素上で右マウスボタンが押された</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">dblclick</td>\n<td style=\"text-align:left\">要素上でマウスボタンがダブルクリックされた</td>\n</tr>\n</tbody>\n</table>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousedown\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 画面のどこかでマウスボタンが押されたときに呼ばれる</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncontainer<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// idがcontainerの要素上でクリックされたときに呼ばれる</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>マウスイベントを受け取りたい要素に<code>addEventListener</code>で、イベント名とコールバックで呼ばれる関数を登録します。</p>\n<h3>on ～</h3>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmousedown</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 画面のどこかでマウスボタンが押されたときに呼ばれる</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncontainer<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// idがcontainerの要素上でクリックされたときに呼ばれる</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>要素には<code>onmousedown</code>や<code>onclick</code>のような、<code>on{イベント名}</code>というイベントハンドラがあり、これを利用すると<code>addEventListener</code>を使わず簡潔に記述することができます。<br>\nただしイベントハンドラに指定できる関数は一つだけになります。</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>alert(123);<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>alert(456);<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n<p><code>on</code>～系のイベントハンドラは要素の属性でもあるので、HTML から直接記述することができます。</p>\n<h3>マウスイベントの補足</h3>\n<p><code>mouseup</code>は対象の要素外でマウスボタンが押された状態で、対象の要素上に移動し、そこで離された場合でもイベントが発生します。<br>\n<code>click</code>は対象の要素外でマウスボタンが押された状態で、対象の要素上に移動し、そこで離された場合、イベントが発生しません。</p>\n<h2>どのボタンが押されたか</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmousedown</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token operator\">:</span> MouseEvent<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>which<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>MouseEvent の which プロパティからどのボタンが押されたかを数値として確認できます。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">ボタン</th>\n<th style=\"text-align:left\">which</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">左ボタン</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">中央ボタン</td>\n<td style=\"text-align:left\">2</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">右ボタン</td>\n<td style=\"text-align:left\">3</td>\n</tr>\n</tbody>\n</table>\n<h2>キーとの連動</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmousedown</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token operator\">:</span> MouseEvent<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>shiftKey <span class=\"token operator\">&amp;&amp;</span> event<span class=\"token punctuation\">.</span>ctrlKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ShiftキーとCtrlキーを押しながら該当のマウスイベントが発生した場合</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>マウスイベント発生時に特定のキーが押されていたかを確認できます。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">プロパティ</th>\n<th style=\"text-align:left\">キー</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">shiftKey</td>\n<td style=\"text-align:left\">Shift キー</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ctrlKey</td>\n<td style=\"text-align:left\">Ctrl キー</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">altKey</td>\n<td style=\"text-align:left\">Alt キー</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">metaKey</td>\n<td style=\"text-align:left\">Meta キー</td>\n</tr>\n</tbody>\n</table>\n<h2>マウス位置</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmousemove</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token operator\">:</span> MouseEvent<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>pageX<span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>pageY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>clientX<span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>clientY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p><code>(pageX, pageY)</code>, <code>(clientX, clientY)</code>ともにマウス位置を返すプロパティですが、スクロールされているときに返す値の違いが出ます。</p>\n<p><img src=\"./static/images/c01286ec/0.png\" alt=\"\"></p>\n<p><code>pageY</code>はページ最上部からマウスポインタがある位置までの距離ですが、<code>clientY</code>は今ブラウザに表示されている領域最上部からの距離を返します。<br>\nx 軸である<code>pageX</code> / <code>clientX</code>も同様となります。</p>\n<h2>関連記事</h2>\n<ul>\n<li><a href=\"/a7af6575\">キーボード</a></li>\n</ul>\n"}},"__N_SSG":true}