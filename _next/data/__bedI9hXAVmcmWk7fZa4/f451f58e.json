{"pageProps":{"post":{"title":"パーティクルを範囲外で削除する","slug":"f451f58e","content":"<h2>実行例</h2>\n<p><img src=\"./static/images/f451f58e/0.png\" alt=\"\">\n<a href=\"./static/play/f451f58e/index.html\">実行結果を見る</a></p>\n<h2>ソースコード</h2>\n<h3>TypeScript</h3>\n<p><a href=\"./static/code/f451f58e/particle.ts\">particle.ts</a> / <a href=\"./static/code/f451f58e/app.ts\">app.ts</a></p>\n<h2>解説/アルゴリズム</h2>\n<p>パーティクルの要素が画面外に出たら削除するように調整する。</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> particles<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> particle <span class=\"token operator\">=</span> particles<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>particle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  p<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>opacity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  p<span class=\"token punctuation\">.</span><span class=\"token function\">circle</span><span class=\"token punctuation\">(</span>particle<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span> particle<span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n    particle<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> particle<span class=\"token punctuation\">.</span>radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span>\n    p<span class=\"token punctuation\">.</span>width <span class=\"token operator\">&lt;=</span> particle<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> particle<span class=\"token punctuation\">.</span>radius <span class=\"token operator\">||</span>\n    particle<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> particle<span class=\"token punctuation\">.</span>radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span>\n    p<span class=\"token punctuation\">.</span>height <span class=\"token operator\">&lt;=</span> particle<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> particle<span class=\"token punctuation\">.</span>radius\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    particles<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    i<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>Particle#update() で位置の更新を終えた後、画面からはみ出ているなら配列から該当要素の削除を行う。</p>\n<h2>備考</h2>\n<p>速度が極端に小さいといつまでも画面に残るので、小さい値が出ないように調整を行うか、<a href=\"/b56cd6b9\">ライフスパン</a>のような一定時間で必ず消えるような調整を採用するとよりよい。</p>\n"}},"__N_SSG":true}