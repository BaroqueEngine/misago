{"pageProps":{"post":{"title":"12平均律音階","slug":"68f29ac8","content":"<h2>解説/アルゴリズム</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> f0<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">523.25</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 周波数</span>\n<span class=\"token keyword\">const</span> samplingRate<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">44100</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 標本化周波数</span>\n<span class=\"token keyword\">const</span> duration<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 音データの長さ</span>\n<span class=\"token keyword\">const</span> len<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> samplingRate <span class=\"token operator\">*</span> duration<span class=\"token punctuation\">;</span> <span class=\"token comment\">// サンプリング数</span>\n<span class=\"token keyword\">const</span> amp<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 振幅</span>\n<span class=\"token keyword\">const</span> maxScale<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">12</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 音階</span>\n<span class=\"token keyword\">const</span> ratio<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">1.0595</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 次の音の高さへの比率</span>\n\n<span class=\"token keyword\">const</span> audioContext<span class=\"token operator\">:</span> AudioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AudioContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> buffer<span class=\"token operator\">:</span> AudioBuffer <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBuffer</span><span class=\"token punctuation\">(</span>\n  <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  len <span class=\"token operator\">*</span> maxScale<span class=\"token punctuation\">,</span>\n  samplingRate\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> array<span class=\"token operator\">:</span> Float32Array <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> maxScale<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> j<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> index<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> i <span class=\"token operator\">*</span> len <span class=\"token operator\">+</span> j<span class=\"token punctuation\">;</span>\n    array<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">generateSample</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">generateSample</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> scale<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> f<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> f0 <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>ratio<span class=\"token punctuation\">,</span> scale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> amp <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">*</span> f <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> samplingRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> src<span class=\"token operator\">:</span> AudioBufferSourceNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBufferSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsrc<span class=\"token punctuation\">.</span>buffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\nsrc<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DOMContentLoaded\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  button<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"再生する\"</span><span class=\"token punctuation\">;</span>\n  button<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    src<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>12 平均律音階は、1 オクターブあたり 12 個の音の高さから構成される。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">音名</th>\n<th style=\"text-align:left\">音名(ドレミ)</th>\n<th style=\"text-align:left\">Hz</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">C5</td>\n<td style=\"text-align:left\">ド</td>\n<td style=\"text-align:left\">523.25</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">C#5</td>\n<td style=\"text-align:left\">ド#</td>\n<td style=\"text-align:left\">554.37</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">D5</td>\n<td style=\"text-align:left\">レ</td>\n<td style=\"text-align:left\">587.33</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">D#5</td>\n<td style=\"text-align:left\">レ#</td>\n<td style=\"text-align:left\">622.25</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">E5</td>\n<td style=\"text-align:left\">ミ</td>\n<td style=\"text-align:left\">659.26</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">F5</td>\n<td style=\"text-align:left\">ファ</td>\n<td style=\"text-align:left\">698.46</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">F#5</td>\n<td style=\"text-align:left\">ファ#</td>\n<td style=\"text-align:left\">739.99</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">G5</td>\n<td style=\"text-align:left\">ソ</td>\n<td style=\"text-align:left\">783.99</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">G#5</td>\n<td style=\"text-align:left\">ソ#</td>\n<td style=\"text-align:left\">830.61</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">A5</td>\n<td style=\"text-align:left\">ラ</td>\n<td style=\"text-align:left\">880.00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">A#5</td>\n<td style=\"text-align:left\">ラ#</td>\n<td style=\"text-align:left\">932.33</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">B5</td>\n<td style=\"text-align:left\">シ</td>\n<td style=\"text-align:left\">987.77</td>\n</tr>\n</tbody>\n</table>\n"}},"__N_SSG":true}