{"pageProps":{"post":{"title":"キーボード","slug":"a7af6575","content":"<h2>解説/アルゴリズム</h2>\n<p>TypeScript からキーボードの入力を扱うための方法を解説します。</p>\n<h2>キーボードイベント</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">イベント名</th>\n<th style=\"text-align:left\">発生する条件</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">keydown</td>\n<td style=\"text-align:left\">要素上でキーが押された</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">keyup</td>\n<td style=\"text-align:left\">要素上でキーが離された</td>\n</tr>\n</tbody>\n</table>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"keydown\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>event<span class=\"token operator\">:</span> KeyboardEvent<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 画面で任意のキーが押されたときに呼ばれる</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>キーボードイベントを受け取りたい要素に<code>addEventListener</code>で、イベント名とコールバックで呼ばれる関数を登録します。</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">tabindex</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n<p>div のようなフォーカスが当たらない要素に対してキーイベントを設定する場合は<code>tabindex</code>の値を指定しておきます。</p>\n<h3>on ～</h3>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onkeydown</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 画面のどこかで任意のキーが押されたときに呼ばれる</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncontainer<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onkeyup</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// idがcontainerの要素上で任意のキーされたときに呼ばれる</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>要素には<code>onkeydown</code>や<code>onkeyup</code>のような、<code>on{イベント名}</code>というイベントハンドラがあり、これを利用すると<code>addEventListener</code>を使わず簡潔に記述することができます。<br>\nただしイベントハンドラに指定できる関数は一つだけになります。</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token attr-name\">onkeydown</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>console.log(<span class=\"token punctuation\">'</span>test<span class=\"token punctuation\">'</span>);<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">onkeydown</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>console.log(<span class=\"token punctuation\">'</span>test<span class=\"token punctuation\">'</span>);<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">tabindex</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n<p><code>on</code>～系のイベントハンドラは要素の属性でもあるので、HTML から直接記述することができます。</p>\n<h2>どのキーが押されたか</h2>\n<pre class=\"language-typescript\"><code class=\"language-typescript\">document<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onkeydown</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token operator\">:</span> KeyboardEvent<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<pre class=\"language-text\"><code class=\"language-text\">a KeyA\nb KeyB\nc KeyC\nA KeyA\nB KeyB\nC KeyC\n</code></pre>\n<p><code>code</code>は物理的なキー、つまり実際に存在するキーボードで押されたキーそのものに付けられている識別子を返します。例えば A キーなら<code>KeyA</code>、4 キーなら<code>Digit4</code>を返します。</p>\n<p><code>key</code>はキーボードのキーに対応している文字を返します。半角モードに画面に出力される文字を返すといっていいでしょう。このプロパティは大文字/小文字を区別して返します。</p>\n<h2>関連記事</h2>\n<ul>\n<li><a href=\"/c01286ec/\">マウス</a></li>\n</ul>\n"}},"__N_SSG":true}