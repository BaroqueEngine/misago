<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="グラフィックスプログラミング関連技術についての覚え書き"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.3/dist/katex.min.css" integrity="sha384-ThssJ7YtjywV52Gj4JE/1SQEDoMEckXyhkFVwaf4nDSm5OBlXeedVYjuuUd0Yua+" crossorigin="anonymous"/><title>渦巻き | みさご解体新書</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/31a6f04d7f80e58df808.css" as="style"/><link rel="stylesheet" href="/_next/static/css/31a6f04d7f80e58df808.css" data-n-g=""/><link rel="preload" href="/_next/static/css/a7019e71593ecf86edfc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a7019e71593ecf86edfc.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61095c13c5984b221292.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-a3a79aff3ff232b41814.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6b51659702b4e91354dd.js" defer=""></script><script src="/_next/static/chunks/996-9333713592b33abcda8c.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-54b85bfec45890f482f1.js" defer=""></script><script src="/_next/static/J3yT6eG2UXHb-6maOG1RH/_buildManifest.js" defer=""></script><script src="/_next/static/J3yT6eG2UXHb-6maOG1RH/_ssgManifest.js" defer=""></script></head><body class="bg-bg-color"><div id="__next"><div class="min-h-screen bg-bg-color text-white"><main><div class="container mx-auto max-w-full"><h2 class="bg-gray-700 font-index text-lg text-gray-300 py-7 px-7"><a href="/">みさご解体新書</a></h2><article class="px-8 py-20"><h1 class="font-index text-3xl font-bold mb-16 text-center">渦巻き</h1><div class="max-w-4xl mx-auto"><div class="markdown-styles_markdown__1x9gM"><h2>実行例</h2>
<p><img src="./static/images/e0653671/0.jpg" alt="">
<img src="./static/images/e0653671/1.png" alt=""></p>
<h2>ソースコード</h2>
<h3>TypeScript</h3>
<p><a href="./static/code/e0653671/0.jpg">0.jpg</a> / <a href="./static/code/e0653671/app.ts">app.ts</a></p>
<h2>解説/アルゴリズム</h2>
<p>円形内の範囲を回転させるが、外側に行くほど回転が弱まるように設定する。</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> radius <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span> <span class="token comment">// 半径</span>
<span class="token keyword">const</span> maxRad <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span> <span class="token comment">// 最大回転のラジアン値</span>
</code></pre>
<p>半径 <code>radius</code> 内が画像処理の対象で、円の中心部分に近づくにつれて回転が強まり、円の外側に近づくにつれて回転が弱まる。</p>
<p>（円の中心～外側が<code>maxRad～0</code>ラジアンの回転に対応する）</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> dest <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">createImage</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>width<span class="token punctuation">,</span> image<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
dest<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>
  image<span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  image<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
  image<span class="token punctuation">.</span>height<span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  image<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
  image<span class="token punctuation">.</span>height
<span class="token punctuation">)</span><span class="token punctuation">;</span>
dest<span class="token punctuation">.</span><span class="token function">loadPixels</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>あるピクセルを別のピクセルにコピーするアルゴリズムなので、入力と出力画像は分けておく。</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token comment">// 円の中心位置</span>
<span class="token keyword">const</span> cx <span class="token operator">=</span> image<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cy <span class="token operator">=</span> image<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> image<span class="token punctuation">.</span>height<span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> image<span class="token punctuation">.</span>width<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 円の中心から対象位置までの距離を求める</span>
    <span class="token keyword">const</span> dist <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">dist</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 円の中心に近いほどthis.radの値に近づくようにする</span>
    <span class="token comment">// 円の範囲外は回転する必要が無いので0を入れる</span>
    <span class="token keyword">const</span> rad <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>dist<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> radius<span class="token punctuation">,</span> maxRad<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// radラジアンが0より大きければ回転する必要があるので回転行列を使用して回転後の位置を求める</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rad <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> tx <span class="token operator">=</span>
        cx <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> cx<span class="token punctuation">)</span> <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> cy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> ty <span class="token operator">=</span>
        cy <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> cx<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>rad<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> cy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> color <span class="token operator">=</span> <span class="token function">getPixel</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> tx<span class="token punctuation">,</span> ty<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setPixel</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>ピクセルの抜け対策のため、回転後のピクセル (x, y) から回転前のピクセル (tx, ty) を<a href="/3cdbb328">回転行列</a>で求める。</p>
<h2>内部で利用しているアルゴリズム</h2>
<p><a href="/b98d6da4">2 点間の直線距離</a>, <a href="/2e71b23a">範囲変更による値のマッピング</a>, <a href="/3cdbb328">回転行列</a></p>
</div></div></article></div></main></div><footer class="bg-gray-700 text-gray-300"><div class="container mx-auto max-w-full"><div class="py-12 flex flex-col items-center"><h3 class="text-base text-center">miku / BAROQUE ENGINE</h3></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"渦巻き","slug":"e0653671","content":"\u003ch2\u003e実行例\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/e0653671/0.jpg\" alt=\"\"\u003e\n\u003cimg src=\"./static/images/e0653671/1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2\u003eソースコード\u003c/h2\u003e\n\u003ch3\u003eTypeScript\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"./static/code/e0653671/0.jpg\"\u003e0.jpg\u003c/a\u003e / \u003ca href=\"./static/code/e0653671/app.ts\"\u003eapp.ts\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003e解説/アルゴリズム\u003c/h2\u003e\n\u003cp\u003e円形内の範囲を回転させるが、外側に行くほど回転が弱まるように設定する。\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e radius \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e200\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 半径\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e maxRad \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePI\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 最大回転のラジアン値\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e半径 \u003ccode\u003eradius\u003c/code\u003e 内が画像処理の対象で、円の中心部分に近づくにつれて回転が強まり、円の外側に近づくにつれて回転が弱まる。\u003c/p\u003e\n\u003cp\u003e（円の中心～外側が\u003ccode\u003emaxRad～0\u003c/code\u003eラジアンの回転に対応する）\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dest \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateImage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eimage\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ndest\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecopy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  image\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ndest\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eloadPixels\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eあるピクセルを別のピクセルにコピーするアルゴリズムなので、入力と出力画像は分けておく。\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token comment\"\u003e// 円の中心位置\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e cx \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e cy \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e image\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 円の中心から対象位置までの距離を求める\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dist \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cy\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e// 円の中心に近いほどthis.radの値に近づくようにする\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 円の範囲外は回転する必要が無いので0を入れる\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e rad \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emax\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edist\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e radius\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e maxRad\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e// radラジアンが0より大きければ回転する必要があるので回転行列を使用して回転後の位置を求める\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erad \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e tx \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n        cx \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eround\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eMath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erad\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e cx\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erad\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ey \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e cy\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e ty \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n        cy \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eround\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eMath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erad\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e cx\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erad\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ey \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e cy\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e color \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003egetPixel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eimage\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e tx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ty\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003esetPixel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e color\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eピクセルの抜け対策のため、回転後のピクセル (x, y) から回転前のピクセル (tx, ty) を\u003ca href=\"/3cdbb328\"\u003e回転行列\u003c/a\u003eで求める。\u003c/p\u003e\n\u003ch2\u003e内部で利用しているアルゴリズム\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"/b98d6da4\"\u003e2 点間の直線距離\u003c/a\u003e, \u003ca href=\"/2e71b23a\"\u003e範囲変更による値のマッピング\u003c/a\u003e, \u003ca href=\"/3cdbb328\"\u003e回転行列\u003c/a\u003e\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"e0653671"},"buildId":"J3yT6eG2UXHb-6maOG1RH","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>