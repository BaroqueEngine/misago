<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="グラフィックスプログラミング関連技術についての覚え書き"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.3/dist/katex.min.css" integrity="sha384-ThssJ7YtjywV52Gj4JE/1SQEDoMEckXyhkFVwaf4nDSm5OBlXeedVYjuuUd0Yua+" crossorigin="anonymous"/><title>ダイクストラ法 | みさご解体新書</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/31a6f04d7f80e58df808.css" as="style"/><link rel="stylesheet" href="/_next/static/css/31a6f04d7f80e58df808.css" data-n-g=""/><link rel="preload" href="/_next/static/css/a7019e71593ecf86edfc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a7019e71593ecf86edfc.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61095c13c5984b221292.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-a3a79aff3ff232b41814.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6b51659702b4e91354dd.js" defer=""></script><script src="/_next/static/chunks/996-9333713592b33abcda8c.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-54b85bfec45890f482f1.js" defer=""></script><script src="/_next/static/uSljV1Ilwp71xVlanF4jV/_buildManifest.js" defer=""></script><script src="/_next/static/uSljV1Ilwp71xVlanF4jV/_ssgManifest.js" defer=""></script></head><body class="bg-bg-color"><div id="__next"><div class="min-h-screen bg-bg-color text-white"><main><div class="container mx-auto max-w-full"><h2 class="bg-gray-700 font-index text-lg text-gray-300 py-7 px-7"><a href="/">みさご解体新書</a></h2><article class="px-8 py-20"><h1 class="font-index text-3xl font-bold mb-16 text-center">ダイクストラ法</h1><div class="max-w-4xl mx-auto"><div class="markdown-styles_markdown__1x9gM"><h2>解説/アルゴリズム</h2>
<p><img src="./static/images/5b32c17c/1.png" alt=""></p>
<p>辺に重みが付いているグラフのことを重み付きグラフと呼び、上記のような形となる。</p>
<p>重みは頂点間の移動距離や時間を表しており、上記の ABCD の各頂点は駅名、辺の数字は駅間の移動時間だと考えてみる。</p>
<p>たとえば A 駅から D 駅までを最短の時間で移動したい場合、A 駅から D 駅へと直接移動すると 20 分かかるが、A 駅-&gt;B 駅-&gt;C 駅-&gt;D 駅と移動すると 18 分で済む。</p>
<p>このように重み付きグラフの場合、移動する頂点の数が短かければ最短経路になるとは限らない。</p>
<p>これから説明するダイクストラ法は重み付きグラフにおいて最短経路を求めるアルゴリズムとなる。</p>
<p>ただし辺の重みに負数が含まれる場合はダイクストラ法を利用することはできない。</p>
<p><img src="./static/images/5b32c17c/2.png" alt=""></p>
<p>新たに重み付きグラフを用意して、頂点 A が開始地点だとする。</p>
<p><img src="./static/images/5b32c17c/3.png" alt=""></p>
<p>A から開始をしているので、当然ながら A までの最短距離は 0 になる。</p>
<p>画像ではわかりやすいように、確定した頂点の付近にその頂点までの最短距離を書き、頂点の色を赤に変更している。</p>
<ul>
<li>確定頂点: [A]</li>
<li>A までの最短距離: 0 / ルート: [A] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/4.png" alt=""></p>
<p>最短経路が確定した A に繋がっている頂点に A からの距離を書き加えておく。</p>
<p>（A-B / A-F / A-E 間の距離を、各頂点に保持しておく。）</p>
<p>A に繋がっているこれらの頂点は次に最短経路が確定するかもしれない未確定頂点。</p>
<p>画像ではわかりやすいように、未確定頂点の色とルートを青色に変更している。</p>
<ul>
<li>未確定頂点: [B, F, E]</li>
<li>確定頂点: [A]</li>
<li>A までの最短距離: 0 / ルート: [A] (確定)</li>
<li>B までの最短距離: 9 / ルート: [A-B] (未確定)</li>
<li>F までの最短距離: 4 / ルート: [A-F] (未確定)</li>
<li>E までの最短距離: 3 / ルート: [A-E] (未確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/5.png" alt=""></p>
<p>開始地点から一番短い経路で繋がっている未確定頂点を探す。</p>
<p>A-B / A-F / A-E の中では、A-E 間の距離が一番短いので、E まで移動するには、A-E 間が最短であることが確定する。</p>
<p>何故かというと最短経路が確定している A に繋がっている頂点の中で、一番短い経路が A-E なので、他の経路、たとえば A-F や A-B から E の方に周りこんだルートが A-E より小さくなることはありえないから。</p>
<ul>
<li>未確定頂点: [B, F]</li>
<li>確定頂点: [A, E]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 9 [A-B] (未確定)</li>
<li>F までの最短距離: 4 [A-F] (未確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/6.png" alt=""></p>
<p>最短経路が確定した E に繋がっている頂点である D と F に注目する。</p>
<p>D は新しく繋がった未確定頂点。</p>
<p>それに加え、E には 3 という開始地点からの距離が保持されているが、それに E-D 間の距離を足した 8 を D に書き込んでおく。</p>
<p>つまり、まだ未確定だが、開始地点からの最短距離を暫定的に頂点に書き込んでおく。</p>
<p>F はすでに候補になっている頂点なので、開始地点から F までの暫定的な最短距離 4 が書き込まれている。</p>
<p>それがさらに短くできるならば更新を行う。</p>
<p>A-E-F の距離は 5 だが、もともと存在していた A-F の経路の方が短いので、F までの暫定的な最短距離の情報は更新をしない。</p>
<p>今のところ、未確定だが F までの最短経路は A-F のままとなる。</p>
<ul>
<li>未確定頂点: [B, D, F]</li>
<li>確定頂点: [A, E]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 9 [A-B] (未確定)</li>
<li>D までの最短距離: 8 [A-E-D] (未確定)</li>
<li>F までの最短距離: 4 [A-F] (未確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/7.png" alt=""></p>
<p>開始地点から一番短い経路で繋がっている未確定頂点を探す。</p>
<p>A-B / A-F / A-E-D の中では、A-F 間の距離が一番短いので、F まで移動するには、A-F 間が最短であることが確定する。</p>
<ul>
<li>未確定頂点: [B, D]</li>
<li>確定頂点: [A, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 9 [A-B] (未確定)</li>
<li>D までの最短距離: 8 [A-E-D] (未確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/8.png" alt=""></p>
<p>最短経路が確定した F に繋がっている頂点である B と D に注目する。</p>
<p>B と D に書き込まれている最短距離より、A-F から通る距離の方が短ければ、情報を更新する。</p>
<p>B の場合、A-B の距離 9 より A-F-B の距離 7 の方が短いので、B 頂点までの最短経路が 7 に更新される。</p>
<p>D の場合、A-E-D の距離 8 より A-F-D の距離 9 の方が長いので、D 頂点までの最短経路は 8 のままになる。</p>
<ul>
<li>未確定頂点: [B, D]</li>
<li>確定頂点: [A, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 7 [A-F-B] (未確定)</li>
<li>D までの最短距離: 8 [A-E-D] (未確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/9.png" alt=""></p>
<p>開始地点から一番短い経路で繋がっている未確定頂点を探す。</p>
<p>A-B / A-E-D の中では、A-B 間の距離が一番短いので、B まで移動するには、A-B 間が最短であることが確定する。</p>
<ul>
<li>未確定頂点: [D]</li>
<li>確定頂点: [A, B, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 7 [A-F-B] (確定)</li>
<li>D までの最短距離: 8 [A-E-D] (未確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/10.png" alt=""></p>
<p>最短経路が確定した B に繋がっている頂点である C に注目する。</p>
<p>C は新しく繋がった未確定頂点。</p>
<p>B までの最短距離 7 に B-C 間の距離を足した 11 を C に書き込んでおく。</p>
<ul>
<li>未確定頂点: [C, D]</li>
<li>確定頂点: [A, B, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 7 [A-F-B] (確定)</li>
<li>C までの最短距離: 11 [A-F-B-C] (未確定)</li>
<li>D までの最短距離: 8 [A-E-D] (未確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/11.png" alt=""></p>
<p>開始地点から一番短い経路で繋がっている未確定頂点を探す。</p>
<p>A-F-B-C / A-E-D の中では、A-E-D 間の距離が一番短いので、D まで移動するには、A-E-D 間が最短であることが確定する。</p>
<ul>
<li>未確定頂点: [C]</li>
<li>確定頂点: [A, B, D, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 7 [A-F-B] (確定)</li>
<li>C までの最短距離: 11 [A-F-B-C] (未確定)</li>
<li>D までの最短距離: 8 [A-E-D] (確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/12.png" alt=""></p>
<p>最短経路が確定した D に繋がっている頂点である C に注目する。</p>
<p>C に書き込まれている最短距離より、A-E-D から通る距離の方が短ければ、情報を更新する。</p>
<p>C の場合、A-F-B-C の距離 11 より A-E-D-C の距離 10 の方が短いので、C 頂点までの最短経路が 10 に更新される。</p>
<ul>
<li>未確定頂点: [C]</li>
<li>確定頂点: [A, B, D, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 7 [A-F-B] (確定)</li>
<li>C までの最短距離: 10 [A-E-D-C] (未確定)</li>
<li>D までの最短距離: 8 [A-E-D] (確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<p><img src="./static/images/5b32c17c/13.png" alt=""></p>
<p>開始地点から一番短い経路で繋がっている未確定頂点を探す。
未確定頂点は C しか残っていないので、C まで移動するには、A-E-D-C 間が最短であることが確定する。</p>
<ul>
<li>未確定頂点: []</li>
<li>確定頂点: [A, B, C, D, E, F]</li>
<li>A までの最短距離: 0 [A] (確定)</li>
<li>B までの最短距離: 7 [A-F-B] (確定)</li>
<li>C までの最短距離: 10 [A-E-D-C] (確定)</li>
<li>D までの最短距離: 8 [A-E-D] (確定)</li>
<li>F までの最短距離: 4 [A-F] (確定)</li>
<li>E までの最短距離: 3 [A-E] (確定)</li>
</ul>
<h2>コード例</h2>
<pre class="language-cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> ll <span class="token operator">=</span> <span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> P <span class="token operator">=</span> pair<span class="token operator">&lt;</span>ll<span class="token punctuation">,</span> ll<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Edge</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> to<span class="token punctuation">;</span>
  ll cost<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>  <span class="token comment">// 頂点数</span>
  <span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// 始点</span>

  vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Edge<span class="token operator">>></span> <span class="token function">edge</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 辺の登録。例えば一番上は頂点0から頂点1まで移動するのにコストが1かかることを表している</span>
  edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  edge<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  edge<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  edge<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 始点から各頂点までの移動総コスト</span>
  <span class="token comment">// 始点は0、それ以外の頂点は入ることがあり得ない大きい値にしておく</span>
  <span class="token keyword">int</span> INF <span class="token operator">=</span> <span class="token number">1000000000</span><span class="token punctuation">;</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">dist</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> INF<span class="token punctuation">)</span><span class="token punctuation">;</span>
  dist<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// 未確定の頂点の中から始点からの移動総コストが最小のものを高速に取り出すため、</span>
  <span class="token comment">// 優先度付きキューを利用する</span>
  <span class="token comment">// pair{頂点までの暫定コスト, 頂点}</span>
  priority_queue<span class="token operator">&lt;</span>P<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>P<span class="token operator">></span><span class="token punctuation">,</span> greater<span class="token operator">&lt;</span>P<span class="token operator">>></span> pq<span class="token punctuation">;</span>
  <span class="token comment">// 始点と始点までのコスト0を入れておく</span>
  pq<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> s<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 優先度付きキューが空になるまでループ</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>pq<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 未確定の頂点の中から始点からの移動総コストが最小のものを取り出す</span>
    <span class="token comment">// この時点で、始点から取り出した頂点までの最短コストが確定する</span>
    P p <span class="token operator">=</span> pq<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pq<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 具体的な名前に変更</span>
    ll cost <span class="token operator">=</span> p<span class="token punctuation">.</span>first<span class="token punctuation">;</span>
    <span class="token keyword">int</span> cur <span class="token operator">=</span> p<span class="token punctuation">.</span>second<span class="token punctuation">;</span>

    <span class="token comment">// 既にcostより小さい値で確定されているのでスキップ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>cur<span class="token punctuation">]</span> <span class="token operator">&lt;</span> cost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 頂点に繋がっている各頂点を走査</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> edge<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 計算したコストが暫定コストより小さければ更新。</span>
      <span class="token comment">// 次の頂点を優先度付きキューに追加する</span>
      ll new_cost <span class="token operator">=</span> dist<span class="token punctuation">[</span>cur<span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>cost<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>new_cost <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dist<span class="token punctuation">[</span>e<span class="token punctuation">.</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> new_cost<span class="token punctuation">;</span>
        pq<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>new_cost<span class="token punctuation">,</span> e<span class="token punctuation">.</span>to<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> x <span class="token operator">:</span> dist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>キューの仕様上、同じ頂点を追加した際、別々なものとして扱うので、確定した頂点なのにまたキューからその頂点が出てくるということがある。</p>
<p>その場合、無駄な走査を行わないように、 <code>if (dist[cur] &lt; cost)</code> ならスキップを行うという処理を入れるのがポイントとなる。</p>
<h2>計算量</h2>
<p>優先度付きキュー（ヒープ）を用いる場合、計算量は <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|E|log|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span> になる。</p>
</div></div></article></div></main></div><footer class="bg-gray-700 text-gray-300"><div class="container mx-auto max-w-full"><div class="py-12 flex flex-col items-center"><h3 class="text-base text-center">miku / BAROQUE ENGINE</h3></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"ダイクストラ法","slug":"5b32c17c","content":"\u003ch2\u003e解説/アルゴリズム\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e辺に重みが付いているグラフのことを重み付きグラフと呼び、上記のような形となる。\u003c/p\u003e\n\u003cp\u003e重みは頂点間の移動距離や時間を表しており、上記の ABCD の各頂点は駅名、辺の数字は駅間の移動時間だと考えてみる。\u003c/p\u003e\n\u003cp\u003eたとえば A 駅から D 駅までを最短の時間で移動したい場合、A 駅から D 駅へと直接移動すると 20 分かかるが、A 駅-\u0026gt;B 駅-\u0026gt;C 駅-\u0026gt;D 駅と移動すると 18 分で済む。\u003c/p\u003e\n\u003cp\u003eこのように重み付きグラフの場合、移動する頂点の数が短かければ最短経路になるとは限らない。\u003c/p\u003e\n\u003cp\u003eこれから説明するダイクストラ法は重み付きグラフにおいて最短経路を求めるアルゴリズムとなる。\u003c/p\u003e\n\u003cp\u003eただし辺の重みに負数が含まれる場合はダイクストラ法を利用することはできない。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/2.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e新たに重み付きグラフを用意して、頂点 A が開始地点だとする。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/3.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eA から開始をしているので、当然ながら A までの最短距離は 0 になる。\u003c/p\u003e\n\u003cp\u003e画像ではわかりやすいように、確定した頂点の付近にその頂点までの最短距離を書き、頂点の色を赤に変更している。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e確定頂点: [A]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 / ルート: [A] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/4.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e最短経路が確定した A に繋がっている頂点に A からの距離を書き加えておく。\u003c/p\u003e\n\u003cp\u003e（A-B / A-F / A-E 間の距離を、各頂点に保持しておく。）\u003c/p\u003e\n\u003cp\u003eA に繋がっているこれらの頂点は次に最短経路が確定するかもしれない未確定頂点。\u003c/p\u003e\n\u003cp\u003e画像ではわかりやすいように、未確定頂点の色とルートを青色に変更している。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [B, F, E]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 / ルート: [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 9 / ルート: [A-B] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 / ルート: [A-F] (未確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 / ルート: [A-E] (未確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/5.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e開始地点から一番短い経路で繋がっている未確定頂点を探す。\u003c/p\u003e\n\u003cp\u003eA-B / A-F / A-E の中では、A-E 間の距離が一番短いので、E まで移動するには、A-E 間が最短であることが確定する。\u003c/p\u003e\n\u003cp\u003e何故かというと最短経路が確定している A に繋がっている頂点の中で、一番短い経路が A-E なので、他の経路、たとえば A-F や A-B から E の方に周りこんだルートが A-E より小さくなることはありえないから。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [B, F]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, E]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 9 [A-B] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (未確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/6.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e最短経路が確定した E に繋がっている頂点である D と F に注目する。\u003c/p\u003e\n\u003cp\u003eD は新しく繋がった未確定頂点。\u003c/p\u003e\n\u003cp\u003eそれに加え、E には 3 という開始地点からの距離が保持されているが、それに E-D 間の距離を足した 8 を D に書き込んでおく。\u003c/p\u003e\n\u003cp\u003eつまり、まだ未確定だが、開始地点からの最短距離を暫定的に頂点に書き込んでおく。\u003c/p\u003e\n\u003cp\u003eF はすでに候補になっている頂点なので、開始地点から F までの暫定的な最短距離 4 が書き込まれている。\u003c/p\u003e\n\u003cp\u003eそれがさらに短くできるならば更新を行う。\u003c/p\u003e\n\u003cp\u003eA-E-F の距離は 5 だが、もともと存在していた A-F の経路の方が短いので、F までの暫定的な最短距離の情報は更新をしない。\u003c/p\u003e\n\u003cp\u003e今のところ、未確定だが F までの最短経路は A-F のままとなる。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [B, D, F]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, E]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 9 [A-B] (未確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (未確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/7.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e開始地点から一番短い経路で繋がっている未確定頂点を探す。\u003c/p\u003e\n\u003cp\u003eA-B / A-F / A-E-D の中では、A-F 間の距離が一番短いので、F まで移動するには、A-F 間が最短であることが確定する。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [B, D]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 9 [A-B] (未確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/8.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e最短経路が確定した F に繋がっている頂点である B と D に注目する。\u003c/p\u003e\n\u003cp\u003eB と D に書き込まれている最短距離より、A-F から通る距離の方が短ければ、情報を更新する。\u003c/p\u003e\n\u003cp\u003eB の場合、A-B の距離 9 より A-F-B の距離 7 の方が短いので、B 頂点までの最短経路が 7 に更新される。\u003c/p\u003e\n\u003cp\u003eD の場合、A-E-D の距離 8 より A-F-D の距離 9 の方が長いので、D 頂点までの最短経路は 8 のままになる。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [B, D]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 7 [A-F-B] (未確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/9.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e開始地点から一番短い経路で繋がっている未確定頂点を探す。\u003c/p\u003e\n\u003cp\u003eA-B / A-E-D の中では、A-B 間の距離が一番短いので、B まで移動するには、A-B 間が最短であることが確定する。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [D]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, B, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 7 [A-F-B] (確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/10.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e最短経路が確定した B に繋がっている頂点である C に注目する。\u003c/p\u003e\n\u003cp\u003eC は新しく繋がった未確定頂点。\u003c/p\u003e\n\u003cp\u003eB までの最短距離 7 に B-C 間の距離を足した 11 を C に書き込んでおく。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [C, D]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, B, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 7 [A-F-B] (確定)\u003c/li\u003e\n\u003cli\u003eC までの最短距離: 11 [A-F-B-C] (未確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (未確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/11.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e開始地点から一番短い経路で繋がっている未確定頂点を探す。\u003c/p\u003e\n\u003cp\u003eA-F-B-C / A-E-D の中では、A-E-D 間の距離が一番短いので、D まで移動するには、A-E-D 間が最短であることが確定する。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [C]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, B, D, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 7 [A-F-B] (確定)\u003c/li\u003e\n\u003cli\u003eC までの最短距離: 11 [A-F-B-C] (未確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/12.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e最短経路が確定した D に繋がっている頂点である C に注目する。\u003c/p\u003e\n\u003cp\u003eC に書き込まれている最短距離より、A-E-D から通る距離の方が短ければ、情報を更新する。\u003c/p\u003e\n\u003cp\u003eC の場合、A-F-B-C の距離 11 より A-E-D-C の距離 10 の方が短いので、C 頂点までの最短経路が 10 に更新される。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: [C]\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, B, D, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 7 [A-F-B] (確定)\u003c/li\u003e\n\u003cli\u003eC までの最短距離: 10 [A-E-D-C] (未確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"./static/images/5b32c17c/13.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e開始地点から一番短い経路で繋がっている未確定頂点を探す。\n未確定頂点は C しか残っていないので、C まで移動するには、A-E-D-C 間が最短であることが確定する。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e未確定頂点: []\u003c/li\u003e\n\u003cli\u003e確定頂点: [A, B, C, D, E, F]\u003c/li\u003e\n\u003cli\u003eA までの最短距離: 0 [A] (確定)\u003c/li\u003e\n\u003cli\u003eB までの最短距離: 7 [A-F-B] (確定)\u003c/li\u003e\n\u003cli\u003eC までの最短距離: 10 [A-E-D-C] (確定)\u003c/li\u003e\n\u003cli\u003eD までの最短距離: 8 [A-E-D] (確定)\u003c/li\u003e\n\u003cli\u003eF までの最短距離: 4 [A-F] (確定)\u003c/li\u003e\n\u003cli\u003eE までの最短距離: 3 [A-E] (確定)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eコード例\u003c/h2\u003e\n\u003cpre class=\"language-cpp\"\u003e\u003ccode class=\"language-cpp\"\u003e\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026lt;bits/stdc++.h\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eusing\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enamespace\u003c/span\u003e std\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eusing\u003c/span\u003e ll \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003elong\u003c/span\u003e \u003cspan class=\"token keyword\"\u003elong\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eusing\u003c/span\u003e P \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pair\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003ell\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ll\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eEdge\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e to\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  ll cost\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e \u003cspan class=\"token function\"\u003emain\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e n \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// 頂点数\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e s \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// 始点\u003c/span\u003e\n\n  vector\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003evector\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003eEdge\u003cspan class=\"token operator\"\u003e\u003e\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003eedge\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003en\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// 辺の登録。例えば一番上は頂点0から頂点1まで移動するのにコストが1かかることを表している\u003c/span\u003e\n  edge\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush_back\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  edge\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush_back\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  edge\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush_back\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  edge\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush_back\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  edge\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush_back\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// 始点から各頂点までの移動総コスト\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// 始点は0、それ以外の頂点は入ることがあり得ない大きい値にしておく\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e INF \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000000000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  vector\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003edist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003en\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e INF\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  dist\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003es\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// 未確定の頂点の中から始点からの移動総コストが最小のものを高速に取り出すため、\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// 優先度付きキューを利用する\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// pair{頂点までの暫定コスト, 頂点}\u003c/span\u003e\n  priority_queue\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003eP\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e vector\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003eP\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e greater\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003eP\u003cspan class=\"token operator\"\u003e\u003e\u003e\u003c/span\u003e pq\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// 始点と始点までのコスト0を入れておく\u003c/span\u003e\n  pq\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e s\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// 優先度付きキューが空になるまでループ\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003epq\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eempty\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 未確定の頂点の中から始点からの移動総コストが最小のものを取り出す\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// この時点で、始点から取り出した頂点までの最短コストが確定する\u003c/span\u003e\n    P p \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pq\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etop\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    pq\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epop\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e// 具体的な名前に変更\u003c/span\u003e\n    ll cost \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirst\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e cur \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esecond\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e// 既にcostより小さい値で確定されているのでスキップ\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edist\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecur\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e cost\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econtinue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e// 頂点に繋がっている各頂点を走査\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eauto\u003c/span\u003e e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e edge\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecur\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e// 計算したコストが暫定コストより小さければ更新。\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e// 次の頂点を優先度付きキューに追加する\u003c/span\u003e\n      ll new_cost \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dist\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecur\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecost\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enew_cost \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e dist\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eto\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        dist\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eto\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e new_cost\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        pq\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003enew_cost\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eto\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eauto\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e dist\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    cout \u003cspan class=\"token operator\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e endl\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eキューの仕様上、同じ頂点を追加した際、別々なものとして扱うので、確定した頂点なのにまたキューからその頂点が出てくるということがある。\u003c/p\u003e\n\u003cp\u003eその場合、無駄な走査を行わないように、 \u003ccode\u003eif (dist[cur] \u0026lt; cost)\u003c/code\u003e ならスキップを行うという処理を入れるのがポイントとなる。\u003c/p\u003e\n\u003ch2\u003e計算量\u003c/h2\u003e\n\u003cp\u003e優先度付きキュー（ヒープ）を用いる場合、計算量は \u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmi\u003eV\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eO(|E|log|V|)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eo\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e になる。\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"5b32c17c"},"buildId":"uSljV1Ilwp71xVlanF4jV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>